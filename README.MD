# docConverter - Word 表格转换器

本项目是一个简单的桌面应用程序，用于将特定格式的 Word 文档 (.docx) 中的表格数据提取、处理并追加到 Excel 文件 (.xlsx) 中。

## 主要功能

*   **读取 Word 文档:** 自动查找并读取指定 Word 文档中的所有表格。
*   **智能表头匹配:** 识别符合预定义表头结构（允许列名包含或不包含空格）的表格。
*   **数据提取与映射:** 从匹配的表格中提取数据行，并根据预设规则映射到目标 Excel 列。
*   **日期格式处理:** 自动解析多种常见日期格式 (如 `YY.MM.DD`, `YYYY-MM-DD`) 并统一转换为 `YYYY-MM-DD` 格式写入 Excel。
*   **Excel 文件处理:**
    *   如果目标 Excel 文件不存在，则创建新文件并写入表头和数据。
    *   如果目标 Excel 文件已存在且表头匹配，则将新数据追加到文件末尾（第一个工作表）。
    *   如果目标 Excel 文件存在但表头不匹配（或列数不同），则会报错并停止处理。
*   **空行处理:** 自动跳过 Word 表格中的空行（或处理后变为空的行），不在 Excel 中产生多余空行。
*   **日志记录:** 将转换过程中的详细信息（如找到的表格、跳过的空行）和错误（如日期解析失败、文件读写错误）记录到日志文件中，方便追踪和调试。
*   **简单的图形用户界面 (GUI):** 提供易于操作的界面，用于选择源 Word 文件、目标 Excel 文件，并显示转换状态和结果。

## 使用步骤

### 1. 环境准备

*   **安装 Python:** 请确保您的系统已安装 Python 3.x (建议 Python 3.7 或更高版本)。您可以从 [Python 官网](https://www.python.org/) 下载并安装。
*   **下载项目:** 获取本项目的所有文件。
*   **安装依赖:**
    *   打开命令行/终端 (Terminal)。
    *   切换到项目根目录 (包含 `requirements.txt` 文件的目录)。
    *   (可选但推荐) 创建并激活 Python 虚拟环境：
        ```bash
        python -m venv venv
        # Windows
        .\venv\Scripts\activate
        # macOS/Linux
        source venv/bin/activate
        ```
    *   安装所需的库：
        ```bash
        pip install -r requirements.txt
        ```
        这将会安装 `python-docx` 和 `openpyxl` 等必要的库。

### 2. 运行程序

*   确保您处于项目根目录（或已激活虚拟环境）。
*   在命令行/终端中运行主程序：
    ```bash
    python src/main.py
    ```
*   程序将启动图形用户界面。

### 3. 使用图形界面

1.  **选择 Word 文件:** 点击 "选择 Word 文件..." 按钮，浏览并选择包含源数据的 `.docx` 文件。
2.  **选择/指定 Excel 文件:** 点击 "选择/指定 Excel..." 按钮，浏览到您希望保存结果的目录，并输入或选择目标 Excel 文件 (.xlsx) 的名称 (例如 `output.xlsx`)。
    *   如果文件不存在，程序会自动创建。
    *   如果文件已存在，程序会检查表头是否匹配。
3.  **开始转换:** 点击 "开始转换" 按钮。
4.  **查看状态:** 界面下方的状态栏会显示转换进度和最终结果（成功多少行、跳过多少空行、失败多少行）。
5.  **操作结果文件 (转换成功后):**
    *   **打开 Excel 文件:** 点击此按钮用系统默认程序（如 Microsoft Excel）打开生成的 Excel 文件。
    *   **打开所在文件夹:** 点击此按钮打开包含 Excel 文件和日志文件的文件夹。
    *   **打开错误日志:** 如果转换过程中出现错误（失败行数 > 0），此按钮会变为可用，点击可直接打开日志文件查看详情。

## 日志文件说明

*   **位置:** 日志文件会自动生成在您指定的 **目标 Excel 文件所在的目录** 下。
*   **名称:** 日志文件通常命名为 `docConverter_error.log`。
*   **内容:** 日志文件记录了程序运行的关键步骤和遇到的问题：
    *   `INFO`: 记录程序正常运行信息，如找到了哪个表格，成功写入多少行，跳过了哪些空行等。
    *   `WARNING`: 记录一些需要注意但程序仍能继续运行的情况，比如 Word 文档中没有找到任何表格，或单元格包含非法字符被替换为空。
    *   `ERROR`: 记录导致单行数据处理失败或整个过程提前终止的错误，例如日期格式无法解析、Excel 文件写入权限错误、加载现有文件失败等。会包含详细的错误信息和发生位置。
*   **用途:** 当转换结果提示有失败行数时，请检查此日志文件以定位具体原因。 